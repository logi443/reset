{
  "name": "reset_tunnel_kharej",
  "nodes": [
    {
      "name": "tdev",
      "type": "TunDevice",
      "settings": {
        "device-name": "tun0",
        "device-ip": "10.0.0.1/24"
      }
    },
    {
      "name": "rdev",
      "type": "RawDevice",
      "settings": {
        "mode": "injector"
      }
    },
    {
      "name": "cdev",
      "type": "CaptureDevice",
      "settings": {
        "direction": "incoming",
        "filter-mode": "source-ip",
        "ip": "iranip/32"
      }
    },
    {
      "name": "route1_receiver",
      "type": "Layer3Receiver",
      "settings": {
        "device": "tdev"
      },
      "next": "route1_source_changer"
    },
    {
      "name": "route1_source_changer",
      "type": "Layer3IpOverrider",
      "settings": {
        "mode": "source-ip",
        "ipv4": "kharejip"
      },
      "next": "tcp_reset_on"
    },
    {
      "name": "tcp_reset_on",
      "type": "Layer3TcpManipulator",
      "settings": {
        "bit-reset": "on"
      },
      "next": "route1_dest_setter"
    },
    {
      "name": "route1_dest_setter",
      "type": "Layer3IpOverrider",
      "settings": {
        "mode": "dest-ip",
        "ipv4": "iranip"
      },
      "next": "route1_writer"
    },
    {
      "name": "route1_writer",
      "type": "Layer3Sender",
      "settings": {
        "device": "rdev"
      }
    },
    {
      "name": "route2_receiver",
      "type": "Layer3Receiver",
      "settings": {
        "device": "cdev"
      },
      "next": "route2_source_changer"
    },
    {
      "name": "route2_source_changer",
      "type": "Layer3IpOverrider",
      "settings": {
        "mode": "source-ip",
        "ipv4": "10.0.0.2"
      },
      "next": "tcp_reset_off"
    },
    {
      "name": "tcp_reset_off",
      "type": "Layer3TcpManipulator",
      "settings": {
        "bit-reset": "off"
      },
      "next": "route2_dest_setter"
    },
    {
      "name": "route2_dest_setter",
      "type": "Layer3IpOverrider",
      "settings": {
        "mode": "dest-ip",
        "ipv4": "10.0.0.1"
      },
      "next": "route2_writer"
    },
    {
      "name": "route2_writer",
      "type": "Layer3Sender",
      "settings": {
        "device": "tdev"
      }
    }
  ]
}
